;; Import random module
!(import! &self random)

;; Set random seed of default random generator
!(set-random-seed &rng 2)

;; ;; Sample float between 0 and 1 with default random generator
;; !(random-float &rng 0 1)

;; Loop-like function ported from Haskell.  Iterate applying a given
;; function till some condition is reached.
(: until (-> (-> $a Bool)               ; Predicate
             (-> $a $a)                 ; Next
             $a                         ; Initial value
             $a))                       ; Final value
(= (until $p $f $x)
   (trace! (👁 until $p $f $x)
   (if ($p $x) $x (until $p $f ($f $x)))))

;; Add 1
(: succ (-> Number Number))
(= (succ $n) (+ 1 $n))

;; Test if the input is equal to a given value
(: curried-equal-to (-> $a (-> $a Bool)))
(= ((curried-equal-to $n) $x) (== $n $x))

;; [0.6, 0.3] -> 0, 1, 2
(: cat_smp (-> (List Number) Number))
(= (cat_smp $xs)
   (let $rnd (random-float &rng 0 1)
     (trace! (trace cat_smp $rnd)
             (__cat_smp $xs (random-float &rng 0 1) 0 0))))

(: __cat_smp (-> (List Number) Number Number Number Number))
(= (__cat_smp Nil $pb $acc $idx) $idx)
(= (__cat_smp (Cons $head $tail) $pb $acc $idx)
   (if (<= $pb (+ $acc $head))
       $idx
       (__cat_smp $tail $pb (+ $acc $head) (+ 1 $idx))))

!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
!(cat_smp (Cons 0.6 (Cons 0.3 Nil)))
